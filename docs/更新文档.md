## âœ… é˜¶æ®µ 8.1 æŒ‡é’ˆç±»å‹ä¸è¿ç®—æ”¯æŒ - å®Œæˆæ€»ç»“

### å·²å®ç°çš„åŠŸèƒ½ï¼š

1. **AST å±‚**ï¼ˆ`ast.h`ï¼‰ï¼š
   - æ·»åŠ äº† `CN_AST_UNARY_OP_ADDRESS_OF`ï¼ˆå–åœ°å€ &ï¼‰
   - æ·»åŠ äº† `CN_AST_UNARY_OP_DEREFERENCE`ï¼ˆè§£å¼•ç”¨ *ï¼‰

2. **è¯æ³•å±‚**ï¼ˆ`token.h`, `lexer.c`ï¼‰ï¼š
   - æ·»åŠ äº† `CN_TOKEN_ARROW`ï¼ˆ-> è¿ç®—ç¬¦ï¼‰
   - æ­£ç¡®è¯†åˆ« `&`ã€`*`ã€`->` ç¬¦å·

3. **è¯­æ³•å±‚**ï¼ˆ`parser.c`ï¼‰ï¼š
   - æ”¯æŒæŒ‡é’ˆç±»å‹å£°æ˜ï¼š`æ•´æ•°* æŒ‡é’ˆå˜é‡`
   - æ”¯æŒå¤šçº§æŒ‡é’ˆï¼š`æ•´æ•°**`
   - æ”¯æŒå‡½æ•°å‚æ•°æŒ‡é’ˆç±»å‹
   - æ”¯æŒå–åœ°å€å’Œè§£å¼•ç”¨è¿ç®—ç¬¦çš„è§£æ

4. **è¯­ä¹‰å±‚**ï¼ˆ`semantic_passes.c`ï¼‰ï¼š
   - å®ç°æŒ‡é’ˆç®—æœ¯ç±»å‹æ£€æŸ¥ï¼ˆpointer + int, int + pointerï¼‰
   - å®ç°å–åœ°å€çš„ç±»å‹æ¨æ–­ï¼ˆåˆ›å»ºæŒ‡é’ˆç±»å‹ï¼‰
   - å®ç°è§£å¼•ç”¨çš„ç±»å‹æ¨æ–­ï¼ˆæå–æŒ‡å‘çš„ç±»å‹ï¼‰

5. **IR å±‚**ï¼ˆ`ir.h`, `irgen.c`ï¼‰ï¼š
   - æ·»åŠ äº† `CN_IR_INST_ADDRESS_OF` æŒ‡ä»¤
   - æ·»åŠ äº† `CN_IR_INST_DEREF` æŒ‡ä»¤
   - æ­£ç¡®ç”ŸæˆæŒ‡é’ˆæ“ä½œçš„ IR

6. **C åç«¯**ï¼ˆ`cgen.c`ï¼‰ï¼š
   - æ­£ç¡®ç”Ÿæˆå–åœ°å€è¿ç®—ç¬¦ `&`
   - æ­£ç¡®ç”Ÿæˆè§£å¼•ç”¨è¿ç®—ç¬¦ `*`
   - æ­£ç¡®å£°æ˜æŒ‡é’ˆç±»å‹çš„å¯„å­˜å™¨
   - æ”¯æŒæŒ‡é’ˆç®—æœ¯è¿ç®—

7. **æµ‹è¯•**ï¼ˆ`semantics_pointer_test.c`ï¼‰ï¼š
   - æµ‹è¯•æŒ‡é’ˆå£°æ˜å’Œç±»å‹æ¨å¯¼
   - æµ‹è¯•å–åœ°å€è¿ç®—ç¬¦
   - æµ‹è¯•è§£å¼•ç”¨è¿ç®—ç¬¦
   - æµ‹è¯•æŒ‡é’ˆç®—æœ¯è¿ç®—
   - æ‰€æœ‰æµ‹è¯•é€šè¿‡ âœ…

8. **ç¤ºä¾‹ç¨‹åº**ï¼š
   - [pointer_example.cn](file:///c:/Users/ChenChao/Documents/gitcode/CN_Language/examples/pointer_example.cn) - åŸºæœ¬æŒ‡é’ˆæ“ä½œ
   - [pointer_arithmetic.cn](file:///c:/Users/ChenChao/Documents/gitcode/CN_Language/examples/pointer_arithmetic.cn) - æŒ‡é’ˆç®—æœ¯
   - æˆåŠŸç”Ÿæˆæ­£ç¡®çš„ C ä»£ç  âœ…

æ ¹æ®ä¸Šä¸‹æ–‡æ€»ç»“ï¼ŒTODO åˆ—è¡¨å·²ç»å…¨éƒ¨æ ‡è®°ä¸ºå®Œæˆã€‚è®©æˆ‘éªŒè¯ä¸€ä¸‹ï¼š
å®Œç¾ï¼TODO åˆ—è¡¨å·²ç»å…¨éƒ¨æ­£ç¡®æ ‡è®°ã€‚ç°åœ¨è®©æˆ‘åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„æŠ€æœ¯æ€»ç»“æ–‡æ¡£ï¼š

## ğŸ‰ é˜¶æ®µ 8.1 æŒ‡é’ˆç±»å‹ä¸è¿ç®—æ”¯æŒ - å®ŒæˆæŠ¥å‘Š

### âœ… å®ç°æ€»ç»“

**é˜¶æ®µ 8.1 çš„æ‰€æœ‰ 8 ä¸ªå­ä»»åŠ¡å·²å…¨éƒ¨å®Œæˆ**ï¼ŒCN_Language ç¼–è¯‘å™¨ç°åœ¨å®Œæ•´æ”¯æŒæŒ‡é’ˆç±»å‹ç³»ç»Ÿï¼ŒåŒ…æ‹¬ï¼š

### æ ¸å¿ƒå®ç°

#### 1. AST å±‚æ‰©å±•
- **æ–‡ä»¶**: [`include/cnlang/frontend/ast.h`](file:///c:/Users/ChenChao/Documents/gitcode/CN_Language/include/cnlang/frontend/ast.h)
- **æ–°å¢æšä¸¾å€¼**:
  - `CN_AST_UNARY_OP_ADDRESS_OF` - å–åœ°å€è¿ç®—ç¬¦ `&`
  - `CN_AST_UNARY_OP_DEREFERENCE` - è§£å¼•ç”¨è¿ç®—ç¬¦ `*`

#### 2. è¯æ³•åˆ†æå™¨å¢å¼º
- **æ–‡ä»¶**: 
  - [`include/cnlang/frontend/token.h`](file:///c:/Users/ChenChao/Documents/gitcode/CN_Language/include/cnlang/frontend/token.h)
  - [`src/frontend/lexer/lexer.c`](file:///c:/Users/ChenChao/Documents/gitcode/CN_Language/src/frontend/lexer/lexer.c)
  - [`src/frontend/lexer/token.c`](file:///c:/Users/ChenChao/Documents/gitcode/CN_Language/src/frontend/lexer/token.c)
- **æ”¯æŒç¬¦å·**:
  - `&` (å–åœ°å€)
  - `*` (è§£å¼•ç”¨/ä¹˜æ³•ï¼Œæ ¹æ®ä¸Šä¸‹æ–‡åŒºåˆ†)
  - `->` (ç®­å¤´è¿ç®—ç¬¦ï¼Œæ–°å¢ `CN_TOKEN_ARROW`)

#### 3. è¯­æ³•åˆ†æå™¨æ‰©å±•
- **æ–‡ä»¶**: [`src/frontend/parser/parser.c`](file:///c:/Users/ChenChao/Documents/gitcode/CN_Language/src/frontend/parser/parser.c)
- **æ–°å¢åŠŸèƒ½**:
  - æŒ‡é’ˆç±»å‹å£°æ˜ï¼š`æ•´æ•°* p`
  - å¤šçº§æŒ‡é’ˆæ”¯æŒï¼š`æ•´æ•°** pp`
  - å‡½æ•°å‚æ•°æŒ‡é’ˆç±»å‹ï¼š`å‡½æ•° æµ‹è¯•(æ•´æ•°* å‚æ•°)`
  - ä¸€å…ƒæŒ‡é’ˆè¿ç®—ç¬¦è§£æï¼ˆé€’å½’æ”¯æŒï¼‰

#### 4. è¯­ä¹‰åˆ†æå¢å¼º
- **æ–‡ä»¶**: [`src/semantics/checker/semantic_passes.c`](file:///c:/Users/ChenChao/Documents/gitcode/CN_Language/src/semantics/checker/semantic_passes.c)
- **ç±»å‹æ£€æŸ¥**:
  - æŒ‡é’ˆç®—æœ¯ï¼š`pointer + int`ã€`int + pointer`
  - å–åœ°å€ç±»å‹æ¨æ–­ï¼š`&x` â†’ `typeof(x)*`
  - è§£å¼•ç”¨ç±»å‹æ¨æ–­ï¼š`*p` â†’ `typeof(*p)`
  - è§£å¼•ç”¨éæŒ‡é’ˆç±»å‹çš„é”™è¯¯æ£€æµ‹

#### 5. IR ä¸­é—´è¡¨ç¤º
- **æ–‡ä»¶**: 
  - [`include/cnlang/ir/ir.h`](file:///c:/Users/ChenChao/Documents/gitcode/CN_Language/include/cnlang/ir/ir.h)
  - [`src/ir/gen/irgen.c`](file:///c:/Users/ChenChao/Documents/gitcode/CN_Language/src/ir/gen/irgen.c)
- **æ–°å¢ IR æŒ‡ä»¤**:
  - `CN_IR_INST_ADDRESS_OF` - å–åœ°å€æ“ä½œ
  - `CN_IR_INST_DEREF` - è§£å¼•ç”¨æ“ä½œ

#### 6. C åç«¯ä»£ç ç”Ÿæˆ
- **æ–‡ä»¶**: [`src/backend/cgen/cgen.c`](file:///c:/Users/ChenChao/Documents/gitcode/CN_Language/src/backend/cgen/cgen.c)
- **æ­£ç¡®ç”Ÿæˆ**:
  - å–åœ°å€ï¼š`dest = &src;`
  - è§£å¼•ç”¨ï¼š`dest = *src;`
  - æŒ‡é’ˆç±»å‹å¯„å­˜å™¨å£°æ˜ï¼š`int* r1;`
  - æŒ‡é’ˆç®—æœ¯ï¼š`r3 = r2 + 1;`

#### 7. å•å…ƒæµ‹è¯•
- **æ–‡ä»¶**: [`tests/unit/semantics/semantics_pointer_test.c`](file:///c:/Users/ChenChao/Documents/gitcode/CN_Language/tests/unit/semantics/semantics_pointer_test.c)
- **æµ‹è¯•ç”¨ä¾‹**:
  1. `test_pointer_declaration()` - æŒ‡é’ˆå£°æ˜å’Œç±»å‹æ¨å¯¼ âœ…
  2. `test_address_of_operator()` - å–åœ°å€è¿ç®—ç¬¦ âœ…
  3. `test_dereference_operator()` - è§£å¼•ç”¨è¿ç®—ç¬¦ âœ…
  4. `test_pointer_arithmetic()` - æŒ‡é’ˆç®—æœ¯è¿ç®— âœ…
- **æµ‹è¯•ç»“æœ**: 100% é€šè¿‡

#### 8. ç¤ºä¾‹ç¨‹åº
- **åŸºæœ¬æŒ‡é’ˆæ“ä½œ**: [`examples/pointer_example.cn`](file:///c:/Users/ChenChao/Documents/gitcode/CN_Language/examples/pointer_example.cn)
  ```cn
  å‡½æ•° ä¸»ç¨‹åº() {
      æ•´æ•° x = 42;
      æ•´æ•°* p = &x;
      æ•´æ•° y = *p;
      è¿”å› y;
  }
  ```

- **æŒ‡é’ˆç®—æœ¯**: [`examples/pointer_arithmetic.cn`](file:///c:/Users/ChenChao/Documents/gitcode/CN_Language/examples/pointer_arithmetic.cn)
  ```cn
  å‡½æ•° ä¸»ç¨‹åº() {
      æ•´æ•° x = 10;
      æ•´æ•°* p = &x;
      æ•´æ•°* q = p + 1;
      è¿”å› 0;
  }
  ```

### éªŒè¯ç»“æœ

âœ… **ç¼–è¯‘å™¨æµ‹è¯•**: `semantics_pointer_test` é€šè¿‡  
âœ… **C ä»£ç ç”Ÿæˆ**: æ­£ç¡®ç”ŸæˆåŒ…å« `&` å’Œ `*` è¿ç®—ç¬¦çš„ C ä»£ç   
âœ… **ç±»å‹ç³»ç»Ÿ**: æŒ‡é’ˆç±»å‹æ¨æ–­å’Œæ£€æŸ¥æ­£ç¡®å·¥ä½œ  
âœ… **ç«¯åˆ°ç«¯**: CN æºç  â†’ IR â†’ C ä»£ç å…¨é“¾è·¯éªŒè¯æˆåŠŸ

### æŠ€æœ¯äº®ç‚¹

1. **ä¸“ç”¨ IR æŒ‡ä»¤**: ä½¿ç”¨ `ADDRESS_OF` å’Œ `DEREF` è€Œéå¤ç”¨ `MOV` å’Œ `LOAD`ï¼Œè¯­ä¹‰æ›´æ¸…æ™°
2. **é€’å½’ç±»å‹æ”¯æŒ**: æ”¯æŒä»»æ„å±‚çº§çš„æŒ‡é’ˆï¼ˆ`æ•´æ•°**`, `æ•´æ•°***` ç­‰ï¼‰
3. **å®Œæ•´çš„ç±»å‹å®‰å…¨**: åœ¨è¯­ä¹‰åˆ†æé˜¶æ®µæ£€æµ‹éæ³•æŒ‡é’ˆæ“ä½œ
4. **C åç«¯ä¼˜åŒ–**: æ­£ç¡®å£°æ˜ä¸åŒç±»å‹çš„å¯„å­˜å™¨ï¼ˆæ•´æ•°ã€å­—ç¬¦ä¸²ã€æ•°ç»„ã€æŒ‡é’ˆï¼‰

### ä¸‹ä¸€æ­¥å»ºè®®

æ ¹æ® TODO åˆ—è¡¨ï¼Œä¸‹ä¸€ä¸ªå¯ä»¥å®ç°çš„åŠŸèƒ½æ˜¯ï¼š
- **8.2 ç»“æ„ä½“ä¸è”åˆä½“æ”¯æŒ** - ä¸ºç³»ç»Ÿç¼–ç¨‹æä¾›æ›´å¤æ‚çš„æ•°æ®ç»“æ„
- **8.8 ä½æ“ä½œç¬¦æ”¯æŒ** - ä¸ºåº•å±‚ç¼–ç¨‹æä¾›ä½è¿ç®—èƒ½åŠ›

æ­å–œå®Œæˆé˜¶æ®µ 8.1 çš„æ‰€æœ‰ä»»åŠ¡ï¼ğŸŠ