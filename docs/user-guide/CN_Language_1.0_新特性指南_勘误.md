# CN_Language 1.0 新特性指南 - 语法勘误表

**日期**: 2026-01-26  
**状态**: 待修正

---

## 发现的语法错误

根据 `docs/design/CN_Language 语法标准.md`，以下是文档中需要修正的语法错误：

### 1. 变量声明错误

**错误**: 使用了 `变量 整数 x = 42;` 
**正确**: 应该是 `整数 x = 42;` 或 `变量 x = 42;`

**位置**: 
- 不应该同时使用 `变量` 关键字和显式类型

**语法标准**（第4.1节）:
```cn
// 显式类型声明
整数 年龄 = 30;

// 使用变量进行类型推断
变量 计数 = 0;
```

### 2. 数组声明错误

**错误**: `整数 数组[] = {10, 20, 30};`  
**正确**: `数组 整数 数组们 = [10, 20, 30];`

**位置**: 第50行等多处

**语法标准**（第4.1节）:
```cn
数组 整数 数字们 = [1, 2, 3];
数组 字符串 名字们 = ["张三", "李四"];
```

**注意**: 
- 使用 `数组 类型` 而不是 `类型[]`
- 使用方括号 `[]` 而不是花括号 `{}`

### 3. 结构体定义后的分号

**错误**: 结构体定义后有分号
```cn
结构体 点 {
    整数 x;
    整数 y;
};  // ← 不应该有这个分号
```

**正确**: 
```cn
结构体 点 {
    整数 x;
    整数 y;
}
```

**位置**: 第91-94行，第96-99行等多处

**语法标准**（第6.1节）:
```cn
结构体 点 {
    整数 x;
    整数 y;
}
```

### 4. 结构体初始化语法

**错误**: `点 p1 = {10, 20};`  
**可能正确**: 根据标准6.2节，推荐使用 `点 p1 = 点 { x: 10, y: 20 };`  
**或者**: 先声明再赋值

**位置**: 第102行等

**语法标准建议**（第6.2节）:
```cn
点 起点;
起点.x = 0;
起点.y = 0;

// 或者使用字面量（当实现支持时）
点 终点 = 点 { x: 100, y: 200 };
```

### 5. 枚举定义后的分号

**错误**: 
```cn
枚举 颜色 {
    红色 = 0,
    绿色 = 1
};  // ← 可能不需要
```

**需要确认**: 语法标准中没有明确说明枚举后是否需要分号

### 6. 函数返回类型声明

**错误**: `函数 加法(整数 a, 整数 b) -> 整数 {`  
**正确**: 根据标准5.1节，不应该在声明中写返回类型

**位置**: 第212行等多处

**语法标准**（第5.1节）:
```cn
函数 加法(整数 左, 整数 右) {
    返回 左 + 右;
}
```

**说明**: 
- 函数声明中不写返回类型
- 返回值类型由 `返回` 语句推断

---

## 需要修正的代码示例位置汇总

### 第一章：指针类型

- **第30-41行**: 指针示例 - 变量声明需要修正
- **第49-62行**: 指针运算示例 - 数组声明需要修正
- **第70-76行**: 多级指针示例 - 变量声明需要修正

### 第二章：结构体

- **第91-109行**: 结构体示例 - 分号和初始化语法需要修正
- **第134-138行**: 对齐示例 - 分号需要修正

### 第三章：枚举

- **第154-175行**: 枚举示例 - 需要确认语法

### 第四章：函数指针

- **第209-235行**: 函数指针示例 - 返回类型声明需要修正

### 其他章节

- 需要逐章检查所有代码示例

---

## 修正优先级

### 高优先级（明确违反语法标准）

1. ✅ 变量声明：去掉 `变量 整数` 的混用
2. ✅ 数组声明：改为 `数组 整数` 并使用 `[]` 初始化
3. ✅ 结构体分号：移除定义后的分号
4. ✅ 函数返回类型：移除 `-> 类型` 声明

### 中优先级（需要进一步确认）

1. ⚠️ 结构体初始化语法：确认是否支持 `{...}` 或需要使用 `结构体名 {...}`
2. ⚠️ 枚举定义：确认是否需要分号

### 低优先级（改进建议）

1. 💡 示例代码风格：统一缩进和格式
2. 💡 注释说明：增加更多语法说明

---

## 建议的修正流程

1. **立即修正**: 明确违反语法标准的错误（高优先级）
2. **查阅示例**: 参考 `examples/` 目录中的实际 `.cn` 文件
3. **编译验证**: 使用 `cnc` 编译器验证修正后的语法
4. **同步更新**: 同时修正三个新创建的文档
   - `CN_Language_1.0_新特性指南.md`
   - `CN_Language_1.0_迁移指南.md`
   - API文档中的示例

---

## 参考资料

- `docs/design/CN_Language 语法标准.md` - 项目语法约定
- `docs/specifications/CN_Language 语言规范草案（核心子集）.md` - 权威规范
- `examples/` - 实际可编译的示例代码

---

**维护者**: CN_Language开发团队  
**下次审查**: 修正完成后
