# CN_Language 运行时绑定规范

本文档明确了 CN_Language 语言特性与运行时库（Runtime）之间的绑定关系。

## 1. 核心类型绑定

| 语言类型 | C 映射类型 | 运行时依赖 | 说明 |
| :--- | :--- | :--- | :--- |
| `整数` (int) | `long long` | 无 | 基础算术运算由 C 编译器直接支持 |
| `布尔` (bool) | `_Bool` | 无 | |
| `字符串` (string) | `char*` | `cn_rt_string_*` | 字符串为不可变的字节序列（UTF-8） |
| `数组` (array) | `void*` | `cn_rt_array_*` | 运行时数组包含长度元数据 |

## 2. 内置函数映射

| 语言内置函数 | 运行时 C 函数 | 作用 |
| :--- | :--- | :--- |
| `打印(内容)` | `cn_rt_print_string` | 打印字符串（目前仅支持字符串） |
| `长度(对象)` | `cn_rt_string_length` 或 `cn_rt_array_length` | 返回字符串字符数或数组元素个数 |

## 3. 内存管理绑定

### 3.1 数组分配与释放
- **创建**：`变量 a = [1, 2, 3];` 映射为 `cn_rt_array_alloc`。
- **释放**：超出作用域或显式销毁时映射为 `cn_rt_array_free`。
- **越界检查**：每次索引访问 `a[i]` 必须先调用 `cn_rt_array_bounds_check`。

### 3.2 字符串操作
- **拼接**：`"A" + "B"` 映射为 `cn_rt_string_concat`。
- **字面量**：源文件中的字符串字面量直接映射为 C 字符串常量。

## 4. 程序生命周期
- 每个生成的 C 程序 `main` 函数必须：
  1. 首先调用 `cn_rt_init()`。
  2. 在返回前调用 `cn_rt_exit()`。
