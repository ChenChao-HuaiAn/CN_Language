# 关键字变更总结 - 2026年1月28日

## 变更概述

本次变更主要涉及两个关键字的语义优化，使其更符合中文语义：

1. **"无"** (CN_TOKEN_KEYWORD_NULL) - 常量关键字
2. **"空类型"** (CN_TOKEN_KEYWORD_VOID) - 类型关键字

## 详细变更

### 1. "无" - 空值常量 (NULL)

- **Token类型**: `CN_TOKEN_KEYWORD_NULL`
- **用途**: 表示空值/空指针
- **对应C语言**: `NULL`
- **示例**: 
  ```cn
  // 未来的指针实现中
  整数* ptr = 无;
  ```

### 2. "空类型" - 空类型 (VOID)

- **Token类型**: `CN_TOKEN_KEYWORD_VOID`
- **用途**: 表示无返回值的函数
- **对应C语言**: `void`
- **示例**:
  ```cn
  // 无返回值函数
  函数 打印问候()
  {
      打印("你好！\n");
  }
  ```

### 3. "布尔" - 布尔类型统一

- **Token类型**: `CN_TOKEN_KEYWORD_BOOL`
- **原名称**: "布尔值"
- **新名称**: "布尔"
- **用途**: 布尔类型声明
- **示例**:
  ```cn
  布尔 是否成功 = 真;
  ```

## 修改文件清单

### 核心实现 (3个文件)
1. `src/frontend/lexer/keywords.c` (L25, L26, L41)
   - 更新关键字定义表

### 测试文件 (1个文件)
2. `tests/unit/lexer_keyword_refined_test.c` (L103)
   - 更新测试用例中的关键字序列

### 文档文件 (1个文件)
3. `docs/specifications/CN_Language 语言规范草案（核心子集）.md` (L138-141)
   - 更新关键字说明

### 工具链文件 (1个文件)
4. `tools/vscode/cnlang-lsp/cnlang.tmLanguage.json` (L104, L112)
   - 更新语法高亮规则

### 构建系统 (2个文件)
5. `tests/unit/CMakeLists.txt` (多处)
   - 添加 keywords.c 依赖到所有使用lexer的测试

6. `tests/integration/CMakeLists.txt` (L5)
   - 添加 keywords.c 依赖到PARSER_TEST_DEPENDENCIES

### 示例文件 (1个文件)
7. `examples/test_null_void_keywords.cn` (新增)
   - 演示"无"和"空类型"关键字的使用

## 测试验证

### 单元测试
- ✅ `lexer_keyword_refined_test` - 词法关键字测试通过
- ✅ `parser_hello_world_test` - 解析器测试通过

### 编译测试
- ✅ `cnc.exe` - 编译器编译成功
- ✅ `cnlsp.exe` - 语言服务器编译成功
- ✅ `cnfmt.exe` - 格式化工具编译成功
- ✅ `cncheck.exe` - 检查工具编译成功
- ✅ `cnrepl.exe` - REPL编译成功
- ✅ 全部单元测试编译成功
- ✅ 全部集成测试编译成功

### 示例验证
```bash
.\build\src\Debug\cnc.exe examples\test_null_void_keywords.cn
# 输出: 编译成功
```

## 兼容性说明

### 向后兼容
- ✅ 现有使用"布尔"的代码无需修改（之前就是"布尔"）
- ✅ "无"和"空类型"是新语义，不影响现有代码

### 需要注意
- 如果代码中之前使用了"空"关键字，需要改为"无"（常量）或"空类型"（类型）
- "布尔值"需要改为"布尔"

## 语义设计理念

本次关键字设计遵循以下原则：

1. **简洁性**: "布尔"比"布尔值"更简洁
2. **明确性**: "无"表示没有值，"空类型"表示没有返回类型
3. **一致性**: 与其他类型关键字（整数、小数、字符串）保持一致的命名风格

## 后续工作

- [ ] 更新用户指南，说明关键字的使用
- [ ] 在编译器错误消息中使用正确的关键字名称
- [ ] 考虑为"无"添加类型推断支持（未来版本）

## 相关文档

- [精简关键字完成报告](./精简关键字完成报告.md)
- [CN_Language 语言规范草案（核心子集）](../../specifications/CN_Language 语言规范草案（核心子集）.md)
- [精简关键字 TODO 列表](./精简关键字 TODO 列表.md)
